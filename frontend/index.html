<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
    <title>Login</title>
</head>
<body>
<div class="container">
    <h1>Login</h1>
    <form id="loginForm" autocomplete="on">
        <input id="usuario" name="usuario" type="text" placeholder="Usu치rio" autocomplete="username" required>
        <input id="senha" name="senha" type="password" placeholder="Senha" autocomplete="current-password" required>
        <button type="submit">Entrar</button>
    </form>
    <div class="link"><a href="registrar.html">Criar conta</a></div>
</div>

<script>
    const form = document.getElementById('loginForm');

    form.addEventListener('submit', async (e) => {
        e.preventDefault(); // evita recarregar a p치gina

        const usuario = form.usuario.value;
        const senha = form.senha.value;

        let r = await fetch("http://localhost:8080/auth/login", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ nomeUsuario: usuario, senha: senha })
        });

        if (r.ok) {
            let dados = await r.json();
            localStorage.setItem("usuario", usuario);
            localStorage.setItem("grupo", dados.grupo);
            location.href = "menu.html";
        } else {
            alert("Usu치rio ou senha inv치lidos!");
        }
    });
</script>
</body>
</html>
